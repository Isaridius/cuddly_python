This is Isaridius / Andrew's new code.